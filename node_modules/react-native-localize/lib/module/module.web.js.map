{"version":3,"sources":["module.web.js"],"names":["USES_FAHRENHEIT","USES_IMPERIAL","USES_RTL_LAYOUT","CURRENCIES","getCountryCode","languageTagParts","getLocaleFromLanguageTag","languageTag","countryCodeFallback","splitted","split","languageCode","countryCode","isRTL","includes","getFirstCountryCode","languageTags","i","length","generateConstants","locales","currencies","forEach","locale","currency","find","_","push","numberFormatter","Intl","NumberFormat","dateFormatter","DateTimeFormat","hour","numberSeparators","format","replace","numberFormatSettings","decimalSeparator","groupingSeparator","eveningDate","Date","uses24HourClock","match","calendar","country","temperatureUnit","timeZone","resolvedOptions","usesMetricSystem","handlers","Set","constants","navigator","languages","window","addEventListener","handler"],"mappings":"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","sourcesContent":["// @flow\n\nimport {\n  USES_FAHRENHEIT,\n  USES_IMPERIAL,\n  USES_RTL_LAYOUT,\n  CURRENCIES,\n} from \"./constants\";\n\nimport type { Locale, LocalizationConstants } from \"./types\";\n\nfunction getCountryCode(languageTagParts: string[]): ?string {\n  // overwrite Latin America and Caribbean region\n  return languageTagParts[1] === \"419\" ? \"UN\" : languageTagParts[1];\n}\n\nfunction getLocaleFromLanguageTag(\n  languageTag: string,\n  countryCodeFallback: string,\n): Locale {\n  const splitted = languageTag.split(\"-\");\n  const languageCode = splitted[0];\n  const countryCode = getCountryCode(splitted) || countryCodeFallback;\n\n  return {\n    languageCode: languageCode,\n    countryCode,\n    languageTag: `${languageCode}-${countryCode}`,\n    isRTL: USES_RTL_LAYOUT.includes(languageCode),\n  };\n}\n\nfunction getFirstCountryCode(languageTags: $ReadOnlyArray<string>): ?string {\n  for (let i = 0; i < languageTags.length; i++) {\n    const countryCode = getCountryCode(languageTags[i].split(\"-\"));\n\n    if (countryCode) {\n      return countryCode;\n    }\n  }\n}\n\nfunction generateConstants(\n  languageTags: $ReadOnlyArray<string>,\n): LocalizationConstants {\n  const countryCode = getFirstCountryCode(languageTags);\n  const locales: Locale[] = [];\n  const currencies: string[] = [];\n\n  languageTags.forEach(languageTag => {\n    const locale = getLocaleFromLanguageTag(languageTag, countryCode);\n    const currency = CURRENCIES[locale.countryCode];\n\n    if (!locales.find(_ => _.languageTag === locale.languageTag)) {\n      locales.push(locale);\n    }\n\n    if (currency && !currencies.includes(currency)) {\n      currencies.push(currency);\n    }\n  });\n\n  if (currencies.length === 0) {\n    currencies.push(\"USD\");\n  }\n\n  const numberFormatter = new Intl.NumberFormat(locales[0].languageTag);\n  const dateFormatter = new Intl.DateTimeFormat(locales[0].languageTag, {\n    hour: \"numeric\",\n  });\n\n  const numberSeparators = [\n    ...numberFormatter.format(1000000.1).replace(/\\d/g, \"\"),\n  ];\n  const numberFormatSettings = {\n    decimalSeparator: numberSeparators[numberSeparators.length - 1],\n    groupingSeparator: numberSeparators[0],\n  };\n\n  const eveningDate = new Date(2000, 0, 1, 20);\n  const uses24HourClock = !!dateFormatter.format(eveningDate).match(/am|pm/i);\n\n  return {\n    calendar: \"gregorian\",\n    country: countryCode,\n    currencies,\n    locales,\n    numberFormatSettings,\n    temperatureUnit: USES_FAHRENHEIT.includes(countryCode)\n      ? \"fahrenheit\"\n      : \"celsius\",\n    timeZone: dateFormatter.resolvedOptions().timeZone || \"Etc/UTC\",\n    uses24HourClock,\n    usesMetricSystem: !USES_IMPERIAL.includes(countryCode),\n  };\n}\n\nexport const handlers: Set<Function> = new Set();\nexport let constants: LocalizationConstants = generateConstants(\n  navigator.languages,\n);\n\nwindow.addEventListener(\"languagechange\", () => {\n  constants = generateConstants(navigator.languages);\n  handlers.forEach(handler => handler());\n});\n"]}